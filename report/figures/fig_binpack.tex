\begin{figure}[t]
    \centering
    \begin{tikzpicture}[node distance=1cm, auto]  
    
        % ------------------
        % nodes
        % ------------------
        
        \node[bluenode, label=right:$tp_1$] (endpoint1) {$E_1$};
        \node[mylabel, left=of endpoint1] {Outer Loop};
        
        \node[orangenode, below=1cm of endpoint1] (B) {$B$};
        \node[mylabel, left=of B] {Best Fit Decreasing};
        
        \node[bluenode, below=2cm of B, label=right:$\bowtie tp_2$] (endpoint3) {$E_3$};
        \node[bluenode, left=of endpoint3, label=right:$\bowtie tp_2$] (endpoint2) {$E_2$};
        \node[bluenode, right=of endpoint3, label=right:$\bowtie tp_2$] (endpoint4) {$E_4$};
        
        \node[mylabel, left=of endpoint2] {Inner Loop};
        \node[mydot, below=2cm of endpoint3] (end) {};
        
        % ------------------
        % arrows
        % ------------------
        
        \draw[myarrow] (endpoint1.south) to node[left]{$\{B_1, \dots, B_4\}$} (B.north);
        
        \draw[myarrow] (B.south) to node[left]{$\{B_1, B_2\}$} (endpoint2.north);
        \draw[myarrow] (B.south) to node[left]{$\{B_3\}$} (endpoint3.north);
        \draw[myarrow] (B.south) to node[right]{$\{B_4\}$} (endpoint4.north);
        
        \draw[myarrow] (endpoint2.south) to node[left]{$\{b_1, b_2\}$} (end.north);
        \draw[myarrow] (endpoint3.south) to node[left]{$\{b_3\}$} (end.north);
        \draw[myarrow] (endpoint4.south) to node[right]{$\{b_4\}$} (end.north);
    
    \end{tikzpicture}
    \caption{Répartition des bindings par \peneloop avec l'approche Bin Packing, où $tp_1, tp_2$ sont des triples patterns, $B$ l'ensemble des buckets $\{ B_1, \dots, B_4 \}$ formés à partir des bindings produits par l'outer loop, $\{ b_1, \dots, b_4 \}$ l'ensemble des binfings produits par l'inner loop, $E_1$ la source pertinente de $tp_1$ et $E_2, E_3, E_4$ les répliques utilisées comme sources de $tp_2$.} 
    \label{fig:binpacking}
\end{figure}